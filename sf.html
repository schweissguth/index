<!DOCTYPE html>
<html>
<head>
  <title>Export Salesforce Products to JSON</title>
</head>
<body>
  <h1>Export Salesforce Products to JSON</h1>
  <button id="exportButton">Export Products</button>
  <pre id="output"></pre>

  <script>
    // Replace these values with your Salesforce instance URL and access token
    const instanceUrl = 'https://liquidstack.my.salesforce.com';
    const accessToken = ''; // Replace with your actual access token

    async function fetchProducts() {
      const url = `https://liquidstack.my.salesforce.com/services/data/v52.0/query?q=SELECT+Id,Name,ProductCode,Description,IsActive,Family,CreatedDate,LastModifiedDate+FROM+Product2`;
      console.log(url)
      const headers = new Headers({
        'Authorization': `Bearer 00D5Y0000024bGF!AQEAQEB2npfIn9rOgBi7ZKb8HpfmDOAx4ou0k6XMjd7_kSIeU4dWBdNGKsqKp9PLqj67Wbd8f0qujmnS9NU0sWoAozoKPQ7s`,
        'Content-Type': 'application/json'
      });

      try {
        const response = await fetch(url, { headers });
        if (!response.ok) {
          throw new Error(`Error: ${response.status} ${response.statusText}`);
        }

        const data = await response.json();
        return data.records;
      } catch (error) {
        console.error('Failed to fetch products:', error);
        return null;
      }
    }

    document.getElementById('exportButton').addEventListener('click', async () => {
      const products = await fetchProducts();
      if (products) {
        const jsonOutput = JSON.stringify(products, null, 2);
        document.getElementById('output').textContent = jsonOutput;

        // Create a download link for the JSON file
        const blob = new Blob([jsonOutput], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'salesforce_products.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      }
    });
  </script>
</body>
</html>
